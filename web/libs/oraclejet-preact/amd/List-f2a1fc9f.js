define(["exports","preact/jsx-runtime","preact/hooks",'module',"./utils/UNSAFE_classNames","./utils/UNSAFE_mergeProps","./utils/UNSAFE_keys","./LoadMoreCollection-479c6b41","./PRIVATE_VirtualizedCollection","./hooks/UNSAFE_useTabbableMode","./UNSAFE_FocusTrap","./hooks/UNSAFE_useId","./classNames-429bf434","./FocusTrap-94dc8805","./hooks/PRIVATE_useSelection","./hooks/PRIVATE_useCurrentKey","./hooks/PRIVATE_useCollectionFocusRing","./hooks/PRIVATE_useTabbableModeSet","./hooks/PRIVATE_useItemAction","./UNSAFE_Skeleton","./UNSAFE_Flex","./utils/PRIVATE_collectionUtils","./UNSAFE_Selector","./VirtualizedCollection-91797029","./Flex-556d723b","./Skeleton-d9b61f2e"],function(e,t,n,i,s,o,l,r,a,c,u,d,g,m,b,f,v,y,x,h,p,k,j,S,A,C){"use strict";const E=e=>{switch(e){case"listbox":return{list:"listbox",item:"presentation",cell:"option"};case"treegrid":return{list:"treegrid",item:"row",cell:"gridcell"};default:return{list:"grid",item:"row",cell:"gridcell"}}},_="oj-listview-item",T=".oj-listview-item",w="bp2fki",F="_1t4hsho",R="_1dv71q3",I="_14t3n5b",K="_45w5dj",P="_1s6e6j3",V="_1ry1qaz",N="_1bxjeg",M="_12r45km",z="_3hvc32",O="_1na3l15";function U({children:e,itemKey:i,itemIndex:s,isFocused:o,isFocusRingVisible:l,isGridlineVisible:r,isSelected:a,isTopGridlineVisible:u=!1,isTabbable:b=!1,role:f,selectionMode:v,suggestion:y,currentItemVariant:x}){const h=n.useRef(null),p=n.useMemo(()=>E(f),[f]),k="option"===p.cell?{role:p.cell,"aria-posinset":s+1,"aria-setsize":-1}:{role:p.cell},j=g.classNames([w,_,o&&l&&M,r&&F,u&&R,L(v,a)&&!a&&I,a&&K,a&&"single"===v&&P,"end"===y&&!r&&!(a&&"single"===v)&&V,"highlight"===x&&o&&!a&&N]),S=g.classNames([z,"multiple"===v&&O]);return t.jsx("div",Object.assign({"aria-rowindex":s+1,"data-oj-key":i,class:j,ref:h,role:p.item},y&&{"data-oj-suggestion":!0},"number"==typeof i&&{"data-oj-key-type":"number"},{children:t.jsx("div",Object.assign({id:d.useId(),class:S,"aria-posinset":s+1,"aria-setsize":-1,onKeyDown:e=>{!b||"ArrowDown"!==e.key&&"ArrowUp"!==e.key||e.stopPropagation()},"aria-colindex":1,"aria-selected":"none"!==v?a:void 0},k,{children:t.jsx(c.TabbableModeContext.Provider,Object.assign({value:{isTabbable:b}},{children:t.jsx(m.FocusTrap,Object.assign({isDisabled:!b,restoreFocusRef:!1},{children:e}))}))}))}))}const L=(e,t)=>"none"!==e&&("multiple"===e||!t),D="_11dpqso";function q({children:e,minimumCount:i=1}){const[s,o]=n.useState(!1);n.useEffect(()=>{setTimeout(()=>{o(!0)},50)},[]);const l=g.classNames([D]);return s&&e?t.jsx("div",Object.assign({class:l,role:"presentation"},{children:[...Array(i)].map((t,n)=>e(n))})):null}const H="_1hmfgsh",B="_12cwsk2",G="_1u5y7ru";const Y=e=>{const t=null==e?void 0:e.data,n=$(t);if(0===n)return null;return t.slice(0,n).reduce((e,t,i)=>{const s=t.metadata.key;return i===n-1?e.set(s,"end"):e.set(s,!0),e},new Map)},$=e=>{if(!e)return 0;const t=e.findIndex(e=>!e.metadata.suggestion);return-1===t?0:t},J=(e,t)=>{if(e&&t){const n=t.getBoundingClientRect(),i=e.getBoundingClientRect();i.bottom>n.bottom?t.scrollTop=t.scrollTop+(i.bottom-n.bottom):i.top<n.top&&(t.scrollTop=t.scrollTop-(n.top-i.top))}},Q=(e,t)=>null!=t?t:{scroller:()=>e.current},W={all:!1,keys:new Set},X=(e,t)=>{const n=t.data.map(e=>e.metadata.key),i=n.indexOf(e.value.start),s=n.indexOf(e.value.end),o=Math.min(i,s),l=Math.max(i,s);return-1===o?{offset:0,count:t.totalSize}:n.slice(o,l+1)};function Z({sparkleHeight:e}){if(e<=0)return null;const n=e+"px",i=g.classNames([B]),s=g.classNames([G]);return t.jsx("div",Object.assign({class:s},{children:t.jsx("div",{class:i,style:{height:n}})}),"sparkle")}const ee=t.jsx(q,Object.assign({minimumCount:25},{children:()=>t.jsx(A.Flex,Object.assign({height:"12x",align:"center"},{children:t.jsx(C.Skeleton,{height:"4x"})}))})),te=t.jsx(q,Object.assign({minimumCount:3},{children:()=>t.jsx(A.Flex,Object.assign({height:"12x",align:"center"},{children:t.jsx(C.Skeleton,{height:"4x"})}))})),ne=(e,t)=>{if(t){const n=Math.min(t.offset,e.offset+e.totalSize),i=n-e.offset;i>0&&(e={offset:n,data:e.data.slice(i,i+t.count),totalSize:e.totalSize,sizePrecision:e.sizePrecision})}return e};e.List=function({accessibleSummary:e,allowTabbableMode:i=!0,children:s,currentKey:a,data:c,gridlines:u,loadingIndicator:d=ee,onCurrentKeyChange:m,onLoadRange:h,onSelectionChange:p,onItemAction:A,rangeExtractor:C,role:_="grid",selectedKeys:w=W,selectionMode:F="none",viewportConfig:R,currentItemVariant:I="none",isVirtualized:K=!0}){const P=n.useRef(null),V=n.useMemo(()=>E(_),[_]),N=n.useRef(),M=n.useRef(),z=n.useRef(),[O,L]=n.useState(0),D="none"===F?void 0:"multiple"===F,q=null===c?void 0:"exact"===c.sizePrecision?c.totalSize:-1,B=g.classNames([H]),{currentKeyProps:G}=f.useCurrentKey(e=>k.keyExtractor(e,T),k.getPrevNextKey(P.current,a,!0,T),k.getPrevNextKey(P.current,a,!1,T),a,m),$=e=>{var t;return!!(null===(t=P.current)||void 0===t?void 0:t.contains(e))},[ie,se]=v.useCollectionFocusRing($,["ArrowUp","ArrowDown"]);let oe=!1;const[le,re]=y.useTabbableModeSet($,e=>k.keyExtractor(e,T),a,(e,t)=>{var n;(null===e||$(e))&&(t?(oe=!0,setTimeout(()=>{var e;null===(e=P.current)||void 0===e||e.focus()},0)):null===(n=P.current)||void 0===n||n.focus())},e=>{m&&m({value:e})});n.useEffect(()=>{if(null!=a&&P.current){const e=k.findElementByKey(P.current,a,T);if(e){const t=null==R?void 0:R.scroller();J(e,null!=t?t:P.current);const n=e.querySelector(`[role=${V.cell}]`);n&&P.current.setAttribute("aria-activedescendant",n.id)}}},[a,c,V.cell,R]);const ae=n.useCallback(e=>{p&&(!1===e.value.all&&e.value.keys.size>0&&(N.current=Array.from(e.value.keys.values()).pop()),p(e))},[N,p]),ce=n.useCallback(e=>{if(c&&p){const t=X(e,c);Array.isArray(t)?p({value:{all:!1,keys:new Set(t)},target:null}):(M.current={detail:e,range:{offset:c.offset,count:c.data.length}},h(t))}},[c,p,h]),ue=n.useCallback(()=>{if(P.current&&m&&(!i||le(void 0))){const e=z.current||k.getFirstVisibleKey(P.current,T);l.isKeyDefined(e)&&m({value:e})}},[i,m,le]),de=n.useCallback(e=>{var t,n;const i=k.keyExtractor(e.target,T);i&&"checkbox"===(null===(t=e.relatedTarget)||void 0===t?void 0:t.getAttribute("type"))&&(null===(n=P.current)||void 0===n||n.focus(),m&&i&&m({value:i}))},[m]),ge=n.useCallback(e=>{!l.isKeyDefined(a)&&m&&ue(),!i&&de(e)},[i,a,ue,de,m]),{selectionProps:me}=b.useSelection(e=>e===P.current?void 0===a?null:a:k.keyExtractor(e,T),w,F,!1,"replace",ae,N.current,a,(e,t)=>k.getPrevNextKey(P.current,e,t,T),e=>{if(P.current){const t=k.findElementByKey(P.current,e,T);if(t){const e=null==R?void 0:R.scroller();J(t,null!=e?e:P.current)}}},ce);if(c&&void 0!==M.current&&p){const e=X(M.current.detail,c);Array.isArray(e)&&p({value:{all:!1,keys:new Set(e)},target:null});const t=M.current?M.current.range:{offset:c.offset,count:c.data.length};c=ne(c,t),M.current=void 0,h(t)}const be=n.useMemo(()=>Y(c),[c]),fe=t.jsx(Z,{sparkleHeight:O}),ve=x.useItemAction(a,c,A,T);n.useEffect(()=>{var e,t;if(be){const n=null===(e=P.current)||void 0===e?void 0:e.querySelector("."+S.PLACEHOLDER_STYLE_CLASS);let i=(null==n?void 0:n.offsetHeight)||0;const s=null===(t=P.current)||void 0===t?void 0:t.querySelectorAll("[data-oj-suggestion]");null==s||s.forEach(e=>i+=e.offsetHeight),L(i)}},[be]);const ye=n.useCallback(e=>{const n="multiple"===F?()=>t.jsx(j.Selector,{onChange:ae,rowKey:e.data.metadata.key,selectedKeys:w}):void 0;return{index:e.index,data:e.data.data,metadata:e.data.metadata,selector:n}},[F,w,ae]),xe=e=>{const n=ye(e),o=null==be?void 0:be.get(n.metadata.key),r=i&&le(n.metadata.key),d=a===n.metadata.key&&!r,g=l.containsKey(w,n.metadata.key);return t.jsx(U,Object.assign({isFocused:d,isFocusRingVisible:ie&&!oe,isGridlineVisible:(m=n.index,"visible"===(null==u?void 0:u.item)&&(m+1!==(null==c?void 0:c.totalSize)||"visible"===(null==u?void 0:u.bottom))),isSelected:g,isTabbable:i&&le(n.metadata.key),itemIndex:n.index,itemKey:n.metadata.key,role:_,selectionMode:F,currentItemVariant:I},o&&{suggestion:o},0===n.index&&{isTopGridlineVisible:"visible"===(null==u?void 0:u.item)&&"visible"===(null==u?void 0:u.top)},{children:s(n)}),n.metadata.key);var m};R=Q(P,R);const he=K?t.jsx(S.VirtualizedCollection,Object.assign({data:c,itemSelector:T,loadMoreIndicator:te,onLoadRange:h,rangeExtractor:C,suggestions:fe,viewportConfig:R},{children:xe})):t.jsx(r.LoadMoreCollection,Object.assign({data:c,loadMoreIndicator:te,onLoadRange:h,suggestions:fe,viewportConfig:R},{children:xe})),pe=n.useCallback(e=>{const t=k.keyExtractor(e.target,T);l.isKeyDefined(t)&&(z.current=t)},[]);return t.jsx("div",Object.assign({},o.mergeProps(i?re:{},G,se,me,ve,{onFocus:ge,onPointerDown:pe}),{role:_,"aria-rowcount":q,"aria-colcount":1,ref:P,class:B,tabIndex:0,"aria-label":e,"aria-multiselectable":D},{children:null==c?d:he}))},e.SkeletonContainer=q});
//# sourceMappingURL=List-f2a1fc9f.js.map
